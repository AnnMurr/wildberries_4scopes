(()=>{"use strict";var t={507:(t,e,s)=>{s.d(e,{$:()=>a});class a{static userUrl="https://646e07219c677e23218ae1e2.mockapi.io/users/user";static setUser(t,e,s){return new Promise(((a,r)=>{fetch(this.userUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:t,password:e,token:s,orders:[]})}).then((t=>{t.ok?a():r(new Error("Failed to set user"))})).catch((t=>r(t)))}))}static getUserByLogin(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>t===e.login)))).catch((t=>{throw t}))}static getUserByToken(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>t===e.token.toString())))).catch((t=>{throw t}))}static async changeUserOrders(t,e){const s=await this.getUserByToken(t),a=s.id;return s.orders=e,fetch(`${this.userUrl}/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((t=>{if(t.ok)return t.json();throw new Error("Failed to change user data")})).catch((t=>{throw t}))}}},783:(t,e,s)=>{s.d(e,{c:()=>r});const a=(t,e)=>{const s=document.getElementById("alert-container"),a=document.createElement("div"),r=document.createElement("span");r.innerText=e,a.classList.add("alert"),a.classList.add(`${t}`),a.appendChild(r),s.appendChild(a),setTimeout((()=>{a.classList.add("remove"),setTimeout((()=>{a.remove()}),300)}),3e3)};class r{static error(t){a("error",t)}static warning(t){a("warning",t)}static access(t){a("access",t)}}},434:(t,e,s)=>{s.d(e,{B:()=>n});var a=s(507),r=s(835);function n(){const t=JSON.parse(localStorage.getItem("basketStore")),e=r.w.getTokenStore();e&&a.$.changeUserOrders(e,t)}},865:(t,e,s)=>{s.d(e,{v:()=>a});class a{static cards=[];static getCards(){return this.cards}static setCards(t){this.cards=t}static getSelectedCard(t){return this.cards.find((e=>e.id===t))}}},835:(t,e,s)=>{s.d(e,{w:()=>r});const a="token";class r{static user={};static getTokenStore(){return sessionStorage.getItem(a)}static setTokenStore(t){return sessionStorage.setItem(a,t)}static removeTokenStore(){return sessionStorage.removeItem(a)}}}},e={};function s(a){var r=e[a];if(void 0!==r)return r.exports;var n=e[a]={exports:{}};return t[a](n,n.exports,s),n.exports}s.d=(t,e)=>{for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=s(434);document.querySelector(".cards__inner");var e=s(865),a=s(783);const r=document.querySelector(".cards__inner");let n=!1;r.addEventListener("click",(function(t){if(t.target.classList.contains("card__btn-quick-view")){const s=t.target.dataset.id,a=e.v.getSelectedCard(s);if(a){const t=function(t){const e=document.createElement("div");return e.classList.add("card-modal"),e.innerHTML=`\n\t\t<div class="container">\n\t\t\t<div class="card-modal__wrapper">\n\t\t\t\t<img class="card-modal__img" src="${t.image}">\n\t\t\t\t<div class="card-modal__inner">\n\t\t\t\t\t<div class="modal-header card-modal__header">\n\t\t\t\t\t\t<h2 class="modal-header__title">${t.title}</h2>\n\t\t\t\t\t\t<button class="btn-close" type="button"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class="card-modal__info"><span>Состав:</span> Lorem ipsum dolor sit amet consectetur adipisicing elit. Necessitatibus veniam ipsam nostrum nisi architecto similique praesentium culpa nam illum modi.</p>\n\t\t\t\t\t<div class="card-modal__subinfo">\n\t\t\t\t\t\t<h3 class="card-modal__price">${t.price+"$"}</h3>\n\t\t\t\t\t\t<h4 class="card-modal__old-price">${t.old_price+"$"}</h4>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button type="button" class="card-modal__btn-add-basket" data-id="${t.id}">Добавить в корзину</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`,e}(a);r.appendChild(t)}}})),r.addEventListener("click",(function(s){if(s.target.classList.contains("card__btn-add-basket")||s.target.classList.contains("card-modal__btn-add-basket")){const r=s.target.dataset.id,n=e.v.getSelectedCard(r);if(n){let e=localStorage.getItem("basketStore"),s=[];e&&(s=JSON.parse(e)),s.push(n),localStorage.setItem("basketStore",JSON.stringify(s)),(0,t.B)(),a.c.access("Товар добавлен в корзину")}}})),r.addEventListener("click",(function(t){t.target.classList.contains("card__title")&&(n?(!function(){const t=document.querySelectorAll(".card");for(let e=0;e<t.length;e++)t[e].style.display="flex"}(),n=!1):(!function(t){const e=document.querySelectorAll(".card__title");for(let s=0;s<e.length;s++){const a=e[s].closest(".card");e[s].textContent===t?a.style.display="flex":a.style.display="none"}}(t.target.textContent),n=!0))})),r.addEventListener("click",(function(t){t.target.classList.contains("card__btn-del-all-basket")&&localStorage.removeItem("basketStore")})),r.addEventListener("click",(function(t){t.target.classList.contains("btn-close")&&t.target.closest(".card-modal").remove()}))})()})();