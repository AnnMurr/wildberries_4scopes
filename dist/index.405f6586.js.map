{"mappings":"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","sources":["src/app/page-modules/product-card/product-card.js","src/app/core/utils/order/order.js","src/app/core/API/authenticationApi.js","src/app/stores/users-store/users-store.js","src/app/core/consts/keys.js","src/app/core/utils/cards/show-more.js","src/app/stores/cards-store/cards-store.js"],"sourcesContent":["import { linkStoreToUserData } from \"../../core/utils/order/order.js\"\nimport { hiddenCards } from \"../../core/utils/cards/show-more.js\"\nimport { CardsStore } from \"../../stores/cards-store/cards-store.js\";\n\nconst cardsBox = document.querySelector(\".cards__inner\")\n\nexport function addCards(arrayElements) {\n\tfor (let element of arrayElements) {\n\t\tcardsBox.appendChild(createCardElement(element))\n\t}\n\n\thiddenCards()\n}\n\nfunction createCardElement(element) {\n\tconst item = document.createElement(\"div\")\n\titem.classList.add(\"card\")\n\n\titem.innerHTML = `\n\t<div class=\"card__view\">\n\t\t<img src=\"${element.image}\" alt=\"image\" class=\"card__img\">\n\t\t<button type=\"button\" class=\"card__btn-quick-view\" data-id=\"${\n\t\t\telement.id\n\t\t}\">Быстрый просмотр</button>\n\t</div>\n\t<div class=\"card__inner\">\n\t\t<div class=\"card__info\">\n\t\t\t<h4 class=\"card__title\">${element.title}</h4>\n\t\t\t<h5 class=\"card__price\">${element.price + \"$\"}</h5>\n\t\t</div>\n\t\t<div class=\"card__subinfo\">\n\t\t\t<span class=\"card__discount\">${\"-\" + element.sale + \"%\"}</span>\n\t\t\t<span class=\"card__old-price\">${element.old_price + \"$\"}</span>\n\t\t</div>\n\t</div>\n\t<button type=\"button\" class=\"card__btn-add-basket\" data-id=\"${\n\t\telement.id\n\t}\">В корзину</button>`\n\n\treturn item\n}\n\nfunction createCardModal(element) {\n\tconst item = document.createElement(\"div\")\n\titem.classList.add(\"card-modal\")\n\n\titem.innerHTML = `\n\t\t<div class=\"container\">\n\t\t\t<div class=\"card-modal__wrapper\">\n\t\t\t\t<img class=\"card-modal__img\" src=\"${element.image}\">\n\t\t\t\t<div class=\"card-modal__inner\">\n\t\t\t\t\t<div class=\"modal-header card-modal__header\">\n\t\t\t\t\t\t<h2 class=\"modal-header__title\">${element.title}</h2>\n\t\t\t\t\t\t<button class=\"btn-close\" type=\"button\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class=\"card-modal__info\"><span>Состав:</span> Lorem ipsum dolor sit amet consectetur adipisicing elit. Necessitatibus veniam ipsam nostrum nisi architecto similique praesentium culpa nam illum modi.</p>\n\t\t\t\t\t<div class=\"card-modal__subinfo\">\n\t\t\t\t\t\t<h3 class=\"card-modal__price\">${element.price + \"$\"}</h3>\n\t\t\t\t\t\t<h4 class=\"card-modal__old-price\">${element.old_price + \"$\"}</h4>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button type=\"button\" class=\"card-modal__btn-add-basket\" data-id=\"${\n\t\t\t\t\t\telement.id\n\t\t\t\t\t}\">Добавить в корзину</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`\n\n\treturn item\n}\n\nfunction quickViewClick(event) {\n\tif (event.target.classList.contains(\"card__btn-quick-view\")) {\n\t\tconst cardId = event.target.dataset.id\n\t\tconst selectedCard = CardsStore.getSelectedCard(cardId)\n\t\tif (selectedCard) {\n\t\t\tconst clonedCard = createCardModal(selectedCard)\n\t\t\tcardsBox.appendChild(clonedCard)\n\t\t}\n\t}\n}\n\nfunction removeCardModal(event) {\n\tif (event.target.classList.contains(\"btn-close\")) {\n\t\tconst cardModal = event.target.closest(\".card-modal\")\n\t\tcardModal.remove()\n\t}\n}\n\nfunction addToBasketClick(event) {\n\tif (\n\t\tevent.target.classList.contains(\"card__btn-add-basket\") ||\n\t\tevent.target.classList.contains(\"card-modal__btn-add-basket\")\n\t) {\n\t\tconst cardId = event.target.dataset.id\n\t\tconst selectedCard = CardsStore.getSelectedCard(cardId)\n\t\tif (selectedCard) {\n\t\t\tlet basketStore = localStorage.getItem(\"basketStore\")\n\t\t\tlet basketArray = []\n\n\t\t\tif (basketStore) {\n\t\t\t\tbasketArray = JSON.parse(basketStore)\n\t\t\t}\n\t\t\t\n\t\t\tbasketArray.push(selectedCard)\n\t\t\tlocalStorage.setItem(\"basketStore\", JSON.stringify(basketArray))\n\t\t\tlinkStoreToUserData()\n\t\t}\n\t}\n}\n\nfunction removeAllFromBasketClick(event) {\n\tif (event.target.classList.contains(\"card__btn-del-all-basket\")) {\n\t\tlocalStorage.removeItem(\"basketStore\")\n\t}\n}\n\nlet isFilterActive = false\n\nfunction filterCardsByTitle(title) {\n\tconst cardTitles = document.querySelectorAll(\".card__title\")\n\tfor (let i = 0; i < cardTitles.length; i++) {\n\t\tconst card = cardTitles[i].closest(\".card\")\n\t\tif (cardTitles[i].textContent === title) {\n\t\t\tcard.style.display = \"flex\"\n\t\t} else {\n\t\t\tcard.style.display = \"none\"\n\t\t}\n\t}\n}\n\nfunction resetCardFilter() {\n\tconst cards = document.querySelectorAll(\".card\")\n\tfor (let i = 0; i < cards.length; i++) {\n\t\tcards[i].style.display = \"flex\"\n\t}\n}\n\nfunction cardTitleClick(event) {\n\tif (event.target.classList.contains(\"card__title\")) {\n\t\tif (isFilterActive) {\n\t\t\tresetCardFilter()\n\t\t\tisFilterActive = false\n\t\t} else {\n\t\t\tconst title = event.target.textContent\n\t\t\tfilterCardsByTitle(title)\n\t\t\tisFilterActive = true\n\t\t}\n\t}\n}\n\ncardsBox.addEventListener(\"click\", quickViewClick)\ncardsBox.addEventListener(\"click\", addToBasketClick)\ncardsBox.addEventListener(\"click\", cardTitleClick)\ncardsBox.addEventListener(\"click\", removeAllFromBasketClick)\ncardsBox.addEventListener(\"click\", removeCardModal)","import { AuthenticationApi } from \"../../API/authenticationApi.js\"\nimport { getTokenStore } from \"../../../stores/users-store/users-store.js\"\n\nexport function linkStoreToUserData() {\n    const store = JSON.parse(localStorage.getItem('basketStore'))\n    const token = getTokenStore()\n    if (token) {\n        AuthenticationApi.changeUserOrders(token, store)\n    } \n}\n","class AuthenticationApi {\n    static userUrl = 'https://646e07219c677e23218ae1e2.mockapi.io/users/user'\n\n    static setUser(login, password, token) {\n        return new Promise((resolve, reject) => {\n            fetch(this.userUrl, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    login: login,\n                    password: password,\n                    token: token,\n                    orders: []\n                })\n            })\n                .then(response => {\n                    if (response.ok) {\n                        resolve()\n                    } else {\n                        reject(new Error('Failed to set user'))\n                    }\n                })\n                .catch(error => reject(error))\n        })\n    }\n\n    static getUserByLogin(userData) {\n        return fetch(this.userUrl)\n            .then(response => response.json())\n            .then(data => {\n                return data.find(element => userData === element.login)\n            })\n            .catch(error => { throw error })\n    }\n\n    static getUserByToken(userToken) {\n        return fetch(this.userUrl)\n            .then(response => response.json())\n            .then(data => {\n                return data.find(element => userToken === element.token.toString())\n\n            })\n            .catch(error => { throw error })\n    }\n\n    static async changeUserOrders(userToken, orders) {\n        const userData = await this.getUserByToken(userToken)       \n        const userId = userData.id\n\n        userData.orders = orders\n\n        return fetch(`${this.userUrl}/${userId}`, {\n            method: 'PUT',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(userData)\n        })\n        .then(response => {\n            if (response.ok) {\n                return response.json()\n            } else {\n                throw new Error('Failed to change user data')\n            }\n        })\n        .catch(error => { throw error })\n    }\n}\n\nexport { AuthenticationApi }","import { USER_TOKEN } from \"../../core/consts/keys\"\n\nfunction getTokenStore() {\n    return sessionStorage.getItem(USER_TOKEN)\n}\n\nfunction removeTokenStore() {\n   return sessionStorage.removeItem(USER_TOKEN)\n}\n\nfunction setTokenStore(value) {\n    return sessionStorage.setItem(USER_TOKEN, value)\n}\n\nexport { getTokenStore, removeTokenStore, setTokenStore }\n\nexport class UsersStore {\n    static user = {};\n\n    static getTokenStore() {\n        return sessionStorage.getItem(USER_TOKEN)\n    }\n\n    static setTokenStore(value) {\n        return sessionStorage.setItem(USER_TOKEN, value)\n    }\n\n    static removeTokenStore() {\n        return sessionStorage.removeItem(USER_TOKEN)\n    }\n}","const USER_TOKEN = 'token'\n\nexport { USER_TOKEN }","const cardsInner = document.querySelector('.cards__inner')\nlet numberOfVisibleCards = 9\n\nexport function hiddenCards() {\n    const showMoreBtn = document.querySelector('.cards__btn-show-more')\n    let i = 0;\n    const allCards = Array.from(cardsInner.children)\n    \n    for (i; i < numberOfVisibleCards && i < allCards.length; i++) {\n        allCards[i].classList.add('card_active')\n    }\n\n    allCards.forEach(element => {\n        if(element.classList.contains('card_active')) {\n            setTimeout(()=> element.style.opacity = '1', 100)\n        }\n    })\n    \n    if (i >= allCards.length) {\n        showMoreBtn.style.display = 'none'\n    } else {\n        showMoreBtn.style.display = 'block'\n    }\n\n    showMoreBtn.addEventListener('click', clickShow)\n}\n\nfunction clickShow() {\n    numberOfVisibleCards += 9;\n    hiddenCards()\n}","export class CardsStore {\n    static cards = [];\n\n    static getCards() {\n        return this.cards;\n    }\n\n    static setCards(value) {\n        this.cards = value;\n    }\n\n    static getSelectedCard(id) {\n        return this.cards.find((card) => card.id === id);\n    }\n}\n"],"names":["$77CKc","parcelRequire","$198c17bf53357603$var$cardsBox","document","querySelector","$198c17bf53357603$export$ea7a60f75b7e3e57","arrayElements","element","appendChild","$198c17bf53357603$var$createCardElement","$9b6hp","hiddenCards","item","createElement","classList","add","innerHTML","image","id","title","price","sale","old_price","$198c17bf53357603$var$isFilterActive","addEventListener","event","target","contains","cardId","dataset","selectedCard","$8fKNq","CardsStore","getSelectedCard","clonedCard","$198c17bf53357603$var$createCardModal","basketStore","localStorage","getItem","basketArray","JSON","parse","push","setItem","stringify","linkStoreToUserData","cards","querySelectorAll","i","length","style","display","$198c17bf53357603$var$resetCardFilter","cardTitles","card","closest","textContent","$198c17bf53357603$var$filterCardsByTitle","removeItem","remove","$02iEE","$52f73da14c7107e3$export$fddea017d5d77998","store","token","$3LgNA","getTokenStore","AuthenticationApi","changeUserOrders","$006ea8734ee51aac$export$762f992a2f2efa56","static","login","password","Promise","resolve","reject","fetch","this","userUrl","method","headers","body","orders","then","response","ok","Error","catch","error","userData","json","data","find","userToken","toString","getUserByToken","userId","$fEuAQ","$2bd2cac25a8b640a$export$e837badd9b9a5c9d","sessionStorage","USER_TOKEN","$2bd2cac25a8b640a$export$e71204bf8ea8b4eb","$2bd2cac25a8b640a$export$69df85587fbdbefe","value","$b65252a6988a10ce$export$58762f3a9b4cd9dc","$6aea032b93d5dc9a$var$cardsInner","$6aea032b93d5dc9a$var$numberOfVisibleCards","$6aea032b93d5dc9a$export$675deeb428ea0d2d","showMoreBtn","allCards","Array","from","children","forEach","setTimeout","opacity","$6aea032b93d5dc9a$var$clickShow","$602406364b0c11bd$export$e923354728b29d80"],"version":3,"file":"index.405f6586.js.map"}