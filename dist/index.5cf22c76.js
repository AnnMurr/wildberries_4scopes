function t(t,e,s,n){Object.defineProperty(t,e,{get:s,set:n,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s={},n={},r=e.parcelRequire5951;null==r&&((r=function(t){if(t in s)return s[t].exports;if(t in n){var e=n[t];delete n[t];var r={id:t,exports:{}};return s[t]=r,e.call(r.exports,r,r.exports),r.exports}var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){n[t]=e},e.parcelRequire5951=r),r.register("2bZdl",(function(e,s){t(e.exports,"addCards",(()=>d));var n=r("77CKc"),a=r("9b6hp"),i=r("8fKNq"),c=r("7h1G2");const o=document.querySelector(".cards__inner");function d(t){for(let e of t)o.appendChild(l(e));(0,a.hiddenCards)()}function l(t){const e=document.createElement("div");return e.classList.add("card"),e.innerHTML=`\n\t<div class="card__view">\n\t\t<img src="${t.image}" alt="image" class="card__img">\n\t\t<button type="button" class="card__btn-quick-view" data-id="${t.id}">Быстрый просмотр</button>\n\t</div>\n\t<div class="card__inner">\n\t\t<div class="card__info">\n\t\t\t<h4 class="card__title">${t.title}</h4>\n\t\t\t<h5 class="card__price">${t.price+"$"}</h5>\n\t\t</div>\n\t\t<div class="card__subinfo">\n\t\t\t<span class="card__discount">${"-"+t.sale+"%"}</span>\n\t\t\t<span class="card__old-price">${t.old_price+"$"}</span>\n\t\t</div>\n\t</div>\n\t<button type="button" class="card__btn-add-basket" data-id="${t.id}">В корзину</button>`,e}let u=!1;o.addEventListener("click",(function(t){if(t.target.classList.contains("card__btn-quick-view")){const e=t.target.dataset.id,s=i.CardsStore.getSelectedCard(e);if(s){const t=function(t){const e=document.createElement("div");return e.classList.add("card-modal"),e.innerHTML=`\n\t\t<div class="container">\n\t\t\t<div class="card-modal__wrapper">\n\t\t\t\t<img class="card-modal__img" src="${t.image}">\n\t\t\t\t<div class="card-modal__inner">\n\t\t\t\t\t<div class="modal-header card-modal__header">\n\t\t\t\t\t\t<h2 class="modal-header__title">${t.title}</h2>\n\t\t\t\t\t\t<button class="btn-close" type="button"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class="card-modal__info"><span>Состав:</span> Lorem ipsum dolor sit amet consectetur adipisicing elit. Necessitatibus veniam ipsam nostrum nisi architecto similique praesentium culpa nam illum modi.</p>\n\t\t\t\t\t<div class="card-modal__subinfo">\n\t\t\t\t\t\t<h3 class="card-modal__price">${t.price+"$"}</h3>\n\t\t\t\t\t\t<h4 class="card-modal__old-price">${t.old_price+"$"}</h4>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button type="button" class="card-modal__btn-add-basket" data-id="${t.id}">Добавить в корзину</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`,e}(s);o.appendChild(t)}}})),o.addEventListener("click",(function(t){if(t.target.classList.contains("card__btn-add-basket")||t.target.classList.contains("card-modal__btn-add-basket")){const e=t.target.dataset.id,s=i.CardsStore.getSelectedCard(e);if(s){let t=localStorage.getItem("basketStore"),e=[];t&&(e=JSON.parse(t)),e.push(s),localStorage.setItem("basketStore",JSON.stringify(e)),(0,n.linkStoreToUserData)(),c.AlertService.access("Товар добавлен в корзину")}}})),o.addEventListener("click",(function(t){if(t.target.classList.contains("card__title"))if(u)!function(){const t=document.querySelectorAll(".card");for(let e=0;e<t.length;e++)t[e].style.display="flex"}(),u=!1;else{!function(t){const e=document.querySelectorAll(".card__title");for(let s=0;s<e.length;s++){const n=e[s].closest(".card");e[s].textContent===t?n.style.display="flex":n.style.display="none"}}(t.target.textContent),u=!0}})),o.addEventListener("click",(function(t){t.target.classList.contains("card__btn-del-all-basket")&&localStorage.removeItem("basketStore")})),o.addEventListener("click",(function(t){if(t.target.classList.contains("btn-close")){t.target.closest(".card-modal").remove()}}))})),r.register("77CKc",(function(e,s){t(e.exports,"linkStoreToUserData",(()=>i));var n=r("02iEE"),a=r("3LgNA");function i(){const t=JSON.parse(localStorage.getItem("basketStore")),e=a.UsersStore.getTokenStore();e&&n.AuthenticationApi.changeUserOrders(e,t)}})),r.register("02iEE",(function(e,s){t(e.exports,"AuthenticationApi",(()=>n));class n{static userUrl="https://646e07219c677e23218ae1e2.mockapi.io/users/user";static setUser(t,e,s){return new Promise(((n,r)=>{fetch(this.userUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:t,password:e,token:s,orders:[]})}).then((t=>{t.ok?n():r(new Error("Failed to set user"))})).catch((t=>r(t)))}))}static getUserByLogin(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>t===e.login)))).catch((t=>{throw t}))}static getUserByToken(t){return fetch(this.userUrl).then((t=>t.json())).then((e=>e.find((e=>t===e.token.toString())))).catch((t=>{throw t}))}static async changeUserOrders(t,e){const s=await this.getUserByToken(t),n=s.id;return s.orders=e,fetch(`${this.userUrl}/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((t=>{if(t.ok)return t.json();throw new Error("Failed to change user data")})).catch((t=>{throw t}))}}})),r.register("3LgNA",(function(e,s){t(e.exports,"UsersStore",(()=>a));var n=r("fEuAQ");class a{static user={};static getTokenStore(){return sessionStorage.getItem(n.USER_TOKEN)}static setTokenStore(t){return sessionStorage.setItem(n.USER_TOKEN,t)}static removeTokenStore(){return sessionStorage.removeItem(n.USER_TOKEN)}}})),r.register("fEuAQ",(function(e,s){t(e.exports,"USER_TOKEN",(()=>n));const n="token"})),r.register("9b6hp",(function(e,s){t(e.exports,"hiddenCards",(()=>a));const n=document.querySelector(".cards__inner");let r=9;function a(){const t=document.querySelector(".cards__btn-show-more");let e=0;const s=Array.from(n.children);for(;e<r&&e<s.length;e++)s[e].classList.add("card_active");s.forEach((t=>{t.classList.contains("card_active")&&setTimeout((()=>t.style.opacity="1"),100)})),e>=s.length?t.style.display="none":t.style.display="block",t.addEventListener("click",i)}function i(){r+=9,a()}})),r.register("8fKNq",(function(e,s){t(e.exports,"CardsStore",(()=>n));class n{static cards=[];static getCards(){return this.cards}static setCards(t){this.cards=t}static getSelectedCard(t){return this.cards.find((e=>e.id===t))}}})),r.register("7h1G2",(function(e,s){t(e.exports,"AlertService",(()=>r));const n=(t,e)=>{const s=document.getElementById("alert-container"),n=document.createElement("div"),r=document.createElement("span");r.innerText=e,n.classList.add("alert"),n.classList.add(`${t}`),n.appendChild(r),s.appendChild(n),setTimeout((()=>{n.classList.add("remove"),setTimeout((()=>{n.remove()}),300)}),3e3)};class r{static error(t){n("error",t)}static warning(t){n("warning",t)}static access(t){n("access",t)}}})),r("2bZdl");
//# sourceMappingURL=index.5cf22c76.js.map
